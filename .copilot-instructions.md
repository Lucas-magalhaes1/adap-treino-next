# Copilot Instructions para Adap Treino

## ðŸŽ¯ Sobre o Projeto

**Adap Treino** Ã© um aplicativo web de gerenciamento de treinos 100% mobile-first, desenvolvido em **Next.js 15** com **TypeScript**, **Material-UI**, **Prisma** e **Supabase PostgreSQL**.

**UsuÃ¡rio:** `avea2025` | **Senha:** `avea2025%`

---

## ðŸ—ï¸ Stack TecnolÃ³gico

### Frontend

- **Framework:** Next.js 15.5.6 com Turbopack
- **UI:** Material-UI (MUI) v7.3.4
- **Ãcones:** @mui/icons-material
- **Styling:** Emotion + CSS-in-JS
- **AutenticaÃ§Ã£o:** NextAuth v4.24.11

### Backend

- **ORM:** Prisma v6.2.0
- **Banco de Dados:** PostgreSQL (Supabase)
- **AutenticaÃ§Ã£o:** NextAuth (JWT + Credentials)
- **Hashing:** bcrypt

### DevTools

- **Linguagem:** TypeScript 5
- **Linting:** ESLint 8
- **FormataÃ§Ã£o:** Prettier 3.4.2
- **Build Tool:** Turbopack

---

## ðŸ“ Estrutura do Projeto

```
adap-treino-next/
â”œâ”€â”€ app/                          # Next.js App Router
â”‚   â”œâ”€â”€ (auth)/
â”‚   â”‚   â””â”€â”€ login/page.tsx       # PÃ¡gina de login (mobile-optimized)
â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”œâ”€â”€ login/page.tsx
â”‚   â”‚   â””â”€â”€ logout/page.tsx
â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â”œâ”€â”€ trainings/page.tsx   # Tela de treinos
â”‚   â”‚   â”œâ”€â”€ athletes/page.tsx    # Tela de atletas
â”‚   â”‚   â”œâ”€â”€ models/page.tsx      # Tela de modelos
â”‚   â”‚   â””â”€â”€ settings/page.tsx    # Tela de configuraÃ§Ãµes
â”‚   â”œâ”€â”€ api/auth/[...nextauth]/route.ts
â”‚   â”œâ”€â”€ layout.tsx               # Root layout com SessionProvider
â”‚   â””â”€â”€ globals.css
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ layout/
â”‚   â”‚   â”‚   â””â”€â”€ MainLayout.tsx   # Layout principal com TabBar
â”‚   â”‚   â”œâ”€â”€ screens/
â”‚   â”‚   â”‚   â”œâ”€â”€ TrainingsPage.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ AthletesPage.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ModelsPage.tsx
â”‚   â”‚   â”‚   â””â”€â”€ SettingsPage.tsx
â”‚   â”‚   â””â”€â”€ common/
â”‚   â”‚       â”œâ”€â”€ EmptyState.tsx
â”‚   â”‚       â””â”€â”€ FloatingActionButton.tsx
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ auth.ts              # NextAuth config + handlers
â”‚   â”‚   â””â”€â”€ prisma.ts            # Prisma client singleton
â”‚   â”œâ”€â”€ theme/
â”‚   â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ overrides/
â”‚   â”‚   â”œâ”€â”€ types.d.ts           # Types customizados MUI
â”‚   â”‚   â””â”€â”€ theme.ts             # Tema Material-UI
â”‚   â”œâ”€â”€ providers/
â”‚   â”‚   â”œâ”€â”€ EmotionCacheProvider.tsx
â”‚   â”‚   â”œâ”€â”€ ThemeMuiProvider.tsx
â”‚   â”‚   â””â”€â”€ createEmotionCache.js
â”‚   â””â”€â”€ types/
â”‚       â””â”€â”€ next-auth.d.ts       # Types NextAuth
â”‚
â”œâ”€â”€ prisma/
â”‚   â”œâ”€â”€ schema.prisma            # Schema do banco (Athlete, Training, etc)
â”‚   â””â”€â”€ seed.ts                  # Seed com usuÃ¡rio padrÃ£o
â”‚
â”œâ”€â”€ middleware.ts                # ProteÃ§Ã£o de rotas
â”œâ”€â”€ next.config.ts
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ .prettierrc                  # Config Prettier
â”œâ”€â”€ .eslintrc.json              # Config ESLint
â”œâ”€â”€ .env                        # VariÃ¡veis de ambiente
â”œâ”€â”€ package.json
â”‚
â””â”€â”€ DocumentaÃ§Ã£o/
    â”œâ”€â”€ AUTH_SETUP.md           # Setup de autenticaÃ§Ã£o
    â”œâ”€â”€ SETUP_COMPLETE.md       # Guia de execuÃ§Ã£o completo
    â”œâ”€â”€ SCREEN_STRUCTURE.md     # Estrutura de telas
    â”œâ”€â”€ ATHLETE_SYSTEM_GUIDE.md # Guia de uso do Prisma
    â””â”€â”€ ESLINT_PRETTIER_GUIDE.md
```

---

## ðŸ” AutenticaÃ§Ã£o & AutorizaÃ§Ã£o

### Fluxo de Login

1. UsuÃ¡rio acessa `/auth/login`
2. Digita email e senha
3. NextAuth valida com CredentialsProvider
4. JWT token gerado e armazenado
5. Redireciona para `/dashboard/trainings`

### ProteÃ§Ã£o de Rotas

- **Middleware:** `middleware.ts` protege `/dashboard/*`
- **NÃ£o autenticado:** Redireciona para `/auth/login`
- **Autenticado em `/auth`:** Redireciona para `/dashboard/trainings`

### Componentes Client

- Use `'use client'` + `useSession()` para verificar sessÃ£o
- SessionProvider jÃ¡ estÃ¡ configurado em `layout.tsx`

---

## ðŸ“Š Banco de Dados (Prisma Schema)

### Modelos Principais

#### User (NextAuth)

```prisma
model User {
  id       String  @id @default(cuid())
  email    String  @unique
  password String? // Hash bcrypt
  name     String?
  image    String?
}
```

#### Athlete (Atleta)

```prisma
model Athlete {
  id              Int              @id @default(autoincrement())
  name            String
  age             Int?
  photo           String?
  notes           AthleteNote[]
  trainings       Training[]
  personalRecords PersonalRecord[]
  goals           Goal[]
}
```

#### Training (Treino)

```prisma
model Training {
  id      Int      @id @default(autoincrement())
  userId  Int // ReferÃªncia ao Athlete
  date    DateTime
  notes   String?
  modelId Int? // ReferÃªncia ao TrainingModel
  sportId Int // ReferÃªncia ao Sport
  data    Json? // Dados flexÃ­veis do treino
}
```

#### Goal (Meta)

```prisma
model Goal {
  id                  Int           @id @default(autoincrement())
  athleteId           Int
  performanceMetricId Int
  targetValue         Decimal
  targetDate          DateTime?
  status              String // 'active', 'achieved', 'abandoned'
  goalHistory         GoalHistory[]
}
```

---

## ðŸš€ Scripts DisponÃ­veis

```bash
# Desenvolvimento
yarn dev              # Inicia servidor Next.js (port 3000)
yarn build           # Build para produÃ§Ã£o

# Prisma
yarn prisma:push     # Sincronizar schema com banco
yarn prisma:migrate  # Criar migration
yarn prisma:seed     # Popula usuÃ¡rio padrÃ£o
yarn prisma:studio   # Abre Prisma Studio (port 5555)
yarn prisma:generate # Gera Prisma Client

# Code Quality
yarn lint            # ESLint
yarn lint:fix        # ESLint com fix automÃ¡tico
yarn format          # Prettier em todos os arquivos
yarn format:check    # Verifica formataÃ§Ã£o
```

---

## ðŸŽ¨ ConvenÃ§Ãµes de CÃ³digo

### Componentes React

```typescript
// âœ… CORRETO
'use client'

import { Box, Button } from '@mui/material'

interface MyComponentProps {
  title: string
  onClick?: () => void
}

export function MyComponent({ title, onClick }: MyComponentProps) {
  return (
    <Box sx={{ p: 2 }}>
      <Button onClick={onClick}>{title}</Button>
    </Box>
  )
}
```

### Imports

- âœ… Use caminhos absolutos: `@/components/...`
- âœ… Agrupe imports: React â†’ libs externas â†’ locais
- âœ… Imports nomeados para components MUI

### Tipagem

- âœ… Sempre use interfaces para props
- âœ… Use `React.ReactNode` para children
- âœ… Type safety com TypeScript

### Nomes

- âœ… Componentes: `PascalCase` (MyComponent.tsx)
- âœ… FunÃ§Ãµes: `camelCase` (myFunction())
- âœ… Constantes: `UPPERCASE` (MAX_SIZE)
- âœ… Tipos: `PascalCase` (UserProps)

---

## ðŸ“± Mobile-First Design

### Breakpoints MUI

```typescript
sx={{
  fontSize: { xs: '0.875rem', sm: '1rem', md: '1.125rem' }
  // xs: mobile (0px)
  // sm: tablet (600px)
  // md: desktop (900px)
  // lg: large (1200px)
  // xl: xlarge (1536px)
}}
```

### 100lvh (Logical Viewport Height)

- Usar `minHeight: '100lvh'` em vez de `100vh`
- Melhor em mobile com barra de endereÃ§o

### Container Responsivo

```typescript
<Box sx={{ px: 2, py: 3 }}> // Padding responsivo
  {/* ConteÃºdo */}
</Box>
```

---

## ðŸ”„ Fluxo de Dados

### Server Components vs Client Components

```typescript
// âœ… Server Component (padrÃ£o)
export default async function Page() {
  const data = await db.query() // Seguro, no servidor
  return <ClientComponent data={data} />
}

// âœ… Client Component (interativo)
'use client'
export function ClientComponent({ data }) {
  const [state, setState] = useState()
  return <div onClick={() => setState(...)}>...</div>
}
```

### Uso de Prisma

```typescript
import { prisma } from '@/lib/prisma'

// Em Server Components ou API routes
const athletes = await prisma.athlete.findMany()

// Sempre com error handling
try {
  const user = await prisma.user.findUnique({
    where: { email: 'test@example.com' },
  })
} catch (error) {
  console.error(error)
}
```

---

## ðŸŽ¯ PadrÃµes Comuns

### Criar Componente de Tela

```typescript
// src/components/screens/ExamplePage.tsx
'use client'

import { Box, Container, Typography } from '@mui/material'

export function ExamplePage() {
  return (
    <Container maxWidth="sm" sx={{ py: 3 }}>
      <Typography variant="h4">TÃ­tulo</Typography>
      {/* ConteÃºdo */}
    </Container>
  )
}
```

### Criar Rota Protegida

```typescript
// app/dashboard/example/page.tsx
'use client'

import { MainLayout } from '@/components/layout/MainLayout'
import { ExamplePage } from '@/components/screens/ExamplePage'

export default function ExampleRoute() {
  return (
    <MainLayout>
      <ExamplePage />
    </MainLayout>
  )
}
```

### Query com Prisma

```typescript
const athletes = await prisma.athlete.findMany({
  include: {
    trainings: {
      orderBy: { date: 'desc' },
      take: 10,
    },
  },
})
```

---

## ðŸ”§ Troubleshooting

### Erro: "Cannot find module"

```bash
# SoluÃ§Ã£o
rm -rf .next node_modules
yarn install
yarn prisma:generate
```

### Erro: "theme.vars is undefined"

- Verificar se `ThemeMuiProvider` estÃ¡ em `layout.tsx`
- Verificar `theme.ts` imports

### Erro: "Session not found"

- Verificar `AUTH_SECRET` em `.env`
- Verificar se `SessionProvider` estÃ¡ em `layout.tsx`
- Limpar cookies do navegador

### Build lentamente

- Usar `--turbopack` nos scripts
- Limpar `.next`: `rm -rf .next`

---

## ðŸ“š ReferÃªncias

- [Next.js Docs](https://nextjs.org/docs)
- [Prisma Docs](https://www.prisma.io/docs)
- [NextAuth Docs](https://next-auth.js.org)
- [Material-UI Docs](https://mui.com/material)
- [TypeScript Docs](https://www.typescriptlang.org/docs)

---

## ðŸ’¡ Dicas do Copilot

Quando criar novos componentes, pergunte ao Copilot:

1. **Para componentes de tela:**

   > "Crie um componente React para listar [entidade] com Material-UI, mobile-optimized"

2. **Para integraÃ§Ã£o com banco:**

   > "Crie uma API route para [aÃ§Ã£o] em [entidade] usando Prisma"

3. **Para correÃ§Ãµes:**

   > "Corrija este erro: [erro] seguindo as convenÃ§Ãµes do projeto"

4. **Para features:**
   > "Implemente [feature] mobile-first com NextAuth e Prisma"

---

## âœ¨ Projeto Pronto Para

- âœ… Desenvolvimento de novos componentes
- âœ… IntegraÃ§Ã£o com banco de dados
- âœ… Deploy em produÃ§Ã£o
- âœ… Escalabilidade (adicionar mais telas/features)
